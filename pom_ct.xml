<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>

    <parent>
        <groupId>de.conterra.agiv</groupId>
        <artifactId>ct-agiv</artifactId>
        <version>5.0.4</version>
    </parent>

    <groupId>de.conterra.agiv</groupId>
    <artifactId>ct-agiv-mapviewer-js</artifactId>
    <version>5.0.4</version>

    <dependencies>
        <!-- used for test env in jetty -->
        <dependency>
            <groupId>log4j</groupId>
            <artifactId>log4j</artifactId>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.slf4j</groupId>
            <artifactId>slf4j-log4j12</artifactId>
            <scope>test</scope>
        </dependency>
        <!-- proxy required if wms or other services should be loaded -->
        <dependency>
            <groupId>de.conterra.mapapps</groupId>
            <artifactId>ct-mapapps-proxy</artifactId>
            <version>${mapapps.version}</version>
            <scope>test</scope>
        </dependency>
        <!-- the embedded registry provides a fast way to host the js packages-->
        <dependency>
            <groupId>de.conterra.jsregistry</groupId>
            <artifactId>ct-jsregistry-embedded</artifactId>
            <version>${ct.jsregistry.version}</version>
            <scope>test</scope>
        </dependency>
        <!-- use intern-geezer as test lib -->
        <dependency>
            <groupId>de.conterra.jsrt</groupId>
            <artifactId>ct-jsrt-test-intern-geezer</artifactId>
            <scope>test</scope>
        </dependency>

        <dependency>
            <groupId>de.conterra.jsrt</groupId>
            <artifactId>ct-jsrt-test-doh</artifactId>
            <scope>test</scope>
        </dependency>
    </dependencies>
    <build>
        <sourceDirectory>src/main/js</sourceDirectory>
        <resources>
            <resource>
                <directory>src/main/js</directory>
                <targetPath>${js.build.outputPath}</targetPath>
                <filtering>false</filtering>
            </resource>
            <resource>
                <directory>src/main/js</directory>
                <includes>
                    <include>bundles/agivthemes/**/*</include>
                </includes>
                <targetPath>${js.build.outputPath}</targetPath>
                <filtering>false</filtering>
            </resource>
            <!-- End of customization -->
        </resources>
        <testResources>
            <testResource>
                <directory>src/test/resources</directory>
                <includes>
                    <include>application.properties</include>
                </includes>
                <filtering>true</filtering>
            </testResource>
            <testResource>
                <directory>src/test/resources</directory>
                <excludes>
                    <exclude>application.properties</exclude>
                </excludes>
                <filtering>false</filtering>
            </testResource>
            <testResource>
                <directory>src/test/webapp</directory>
                <includes>
                    <include>**/*</include>
                </includes>
                <filtering>false</filtering>
            </testResource>
        </testResources>

        <plugins>
            <plugin>
                <groupId>de.conterra.maven</groupId>
                <artifactId>setproperties-maven-plugin</artifactId>
                <version>1.0.2</version>
                <executions>
                    <execution>
                        <goals>
                            <goal>setProperties</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <!-- add here properties which are used in plugin configuration resolution -->
                    <properties>
                        <!-- deployment of map.apps installation -->
                        <mapapps.remote.base>${mapapps.remote.base}</mapapps.remote.base>
                        <deployment.admin.username>admin</deployment.admin.username>
                        <deployment.admin.pw>admin</deployment.admin.pw>
                    </properties>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <configuration>
                    <excludes>
                        <exclude>**/*</exclude>
                    </excludes>
                    <source>1.7</source>
                    <target>1.7</target>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-javadoc-plugin</artifactId>
                <configuration>
                    <skip>true</skip>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-dependency-plugin</artifactId>
                <!-- this unpacks the org css/less files for own bundles -->
                <executions>
                    <execution>
                        <id>unpack-themes-src</id>
                        <phase>generate-sources</phase>
                        <goals>
                            <goal>unpack</goal>
                        </goals>
                        <configuration>
                            <stripVersion>true</stripVersion>
                            <artifactItems>
                                <artifactItem>
                                    <!-- unpack mapapps sources -->
                                    <groupId>de.conterra.mapapps</groupId>
                                    <artifactId>ct-mapapps-js-api</artifactId>
                                    <version>${mapapps.version}</version>
                                    <classifier>src</classifier>
                                    <outputDirectory>${project.build.directory}/unpacked</outputDirectory>
                                    <includes>
                                        **/*
                                    </includes>
                                </artifactItem>
                                <artifactItem>
                                    <groupId>com.esri.js</groupId>
                                    <artifactId>ags-js-api</artifactId>
                                    <version>${ags.jsapi.version}</version>
                                    <outputDirectory>${project.build.directory}/unpacked</outputDirectory>
                                    <includes>
                                        **/*
                                    </includes>
                                </artifactItem>
                                <!--<artifactItem>-->
                                <!-- unpack ct-sdi-extension sources -->
                                <!--<groupId>de.conterra.sdi-extension</groupId>-->
                                <!--<artifactId>ct-sdi-extension-client</artifactId>-->
                                <!--<version>${sdi.extension.version}</version>-->
                                <!--<classifier>sources</classifier>-->
                                <!--<outputDirectory>${project.build.directory}/unpacked</outputDirectory>-->
                                <!--<includes>-->
                                <!--bundles/sdi/sdi_themes_extension/winter/**-->
                                <!--</includes>-->
                                <!--</artifactItem>-->
                            </artifactItems>
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <!-- JavaScript files must be encoded with UTF-8! -->
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-resources-plugin</artifactId>
                <configuration>
                    <!-- JavaScript files must be encoded with UTF-8! -->
                    <encoding>UTF-8</encoding>
                </configuration>
            </plugin>
            <plugin>
                <groupId>de.conterra.jsregistry</groupId>
                <artifactId>ct-jsregistry-maven-plugin</artifactId>
                <executions>
                    <execution>
                        <id>build-jsregistry.properties</id>
                        <phase>process-resources</phase>
                        <goals>
                            <goal>buildPacksProperties</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <sourceDirectory>${js.build.outputPath}</sourceDirectory>
                    <outputDirectory>${js.build.outputPath}</outputDirectory>
                </configuration>
            </plugin>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-antrun-plugin</artifactId>
                <executions>
                    <execution>
                        <id>copy_themes</id>
                        <phase>generate-resources</phase>
                        <configuration>
                            <tasks>

                                <!-- We need the commons-->
                                <copy toDir="${js.build.outputPath}/bundles/agivthemes/common" filtering="false">
                                    <fileset dir="${mapapps.build.outputPath}/bundles/base/themes/themes/common" />
                                </copy>
                                <!-- copy agiv commons theme resources -->
                                <copy toDir="${js.build.outputPath}/bundles/agivthemes/common" filtering="false" overwrite="true">
                                    <fileset dir="src/main/js/bundles/agivthemes/common">
                                    </fileset>
                                </copy>

                                <!--Copy the map.apps iconFontGallery to Target-->
                                <copy file="${mapapps.build.outputPath}/bundles/base/themes/themes/webFontsGallery.html" todir="${js.build.outputPath}/bundles/agivthemes" />

                                <!-- START NEAT CREATION -->
                                <!-- copy agiv night theme resources to agiv neat -->
                                <copy toDir="${js.build.outputPath}/bundles/agivthemes/neat" filtering="false" overwrite="true">
                                    <fileset dir="${mapapps.build.outputPath}/bundles/base/themes/themes/winter">
                                        <exclude name="winter.*" />
                                        <exclude name="themeSettings.*" />
                                    </fileset>
                                </copy>

                                <!-- copy agiv neat theme resources to agiv neat -->
                                <copy toDir="${js.build.outputPath}/bundles/agivthemes/neat" filtering="false" overwrite="true">
                                    <fileset dir="src/main/js/bundles/agivthemes/neat">
                                    </fileset>
                                </copy>

                                <!-- copy map.apps templates/common resources to agivtemplates/common -->
                                <copy toDir="${js.build.outputPath}/bundles/agivtemplates/common" filtering="false" overwrite="true">
                                    <fileset dir="${mapapps.build.outputPath}/bundles/base/templates/templates/common">
                                    </fileset>
                                </copy>

                                <!-- copy builder classes to reuse in different bundles -->
                                <copy toDir="${js.build.outputPath}/bundles/historicmaps/config" filtering="false" overwrite="true">
                                    <fileset dir="${mapapps.build.outputPath}/bundles/mapcore/map/config">
                                        <filename name="**/*MapModelBuilderWidget.js" />
                                    </fileset>
                                </copy>
                                <copy toDir="${js.build.outputPath}/bundles/historicmaps/config" filtering="false" overwrite="true">
                                    <fileset dir="${mapapps.build.outputPath}/bundles/mapcore/map/config">
                                        <filename name="**/*MapModelBuilderController.js" />
                                    </fileset>
                                </copy>
                                <copy toDir="${js.build.outputPath}/bundles/historicmaps/config" filtering="false" overwrite="true">
                                    <fileset dir="${mapapps.build.outputPath}/bundles/mapcore/map/config">
                                        <filename name="**/templates/**" />
                                    </fileset>
                                </copy>

                                <copy toDir="${js.build.outputPath}/bundles/splitviewmap/config" filtering="false" overwrite="true">
                                    <fileset dir="${mapapps.build.outputPath}/bundles/mapcore/map/config">
                                        <filename name="**/*MapModelBuilderWidget.js" />
                                    </fileset>
                                </copy>
                                <copy toDir="${js.build.outputPath}/bundles/splitviewmap/config" filtering="false" overwrite="true">
                                    <fileset dir="${mapapps.build.outputPath}/bundles/mapcore/map/config">
                                        <filename name="**/*MapModelBuilderController.js" />
                                    </fileset>
                                </copy>
                                <copy toDir="${js.build.outputPath}/bundles/splitviewmap/config" filtering="false" overwrite="true">
                                    <fileset dir="${mapapps.build.outputPath}/bundles/mapcore/map/config">
                                        <filename name="**/templates/**" />
                                    </fileset>
                                </copy>

                            </tasks>
                        </configuration>
                        <goals>
                            <goal>run</goal>
                        </goals>
                    </execution>
                    <!--<execution>-->
                    <!--<phase>process-resources</phase>-->
                    <!--<id>copy_markers</id>-->
                    <!--<configuration>-->
                    <!--<tasks>-->
                    <!-- copy map marker to report folder -->
                    <!--<copy toDir="${project.build.directory}/classes/reports/images/markers" filtering="false" overwrite="true">-->
                    <!--<fileset dir="${js.build.outputPath}/bundles/agivthemes/neat/images/marker/search">-->
                    <!--<include name="searchMarker_*.png" />-->
                    <!--</fileset>-->
                    <!--</copy>-->

                    <!--</tasks>-->
                    <!--</configuration>-->
                    <!--<goals>-->
                    <!--<goal>run</goal>-->
                    <!--</goals>-->
                    <!--</execution>-->
                </executions>
            </plugin>
            <plugin>
                <groupId>org.lesscss</groupId>
                <artifactId>lesscss-maven-plugin</artifactId>
                <executions>
                    <execution>
                        <phase>process-resources</phase>
                        <goals>
                            <goal>compile</goal>
                        </goals>
                    </execution>
                </executions>
                <configuration>
                    <sourceDirectory>${js.build.outputPath}</sourceDirectory>
                    <outputDirectory>${js.build.outputPath}</outputDirectory>
                    <includes>
                        <include>bundles/**/*.less</include>
                        <include>apps/**/*.less</include>
                    </includes>
                </configuration>
            </plugin>
            <plugin>
                <groupId>com.google.code.maven-replacer-plugin</groupId>
                <artifactId>replacer</artifactId>
                <version>1.5.2</version>
                <executions>
                    <execution>
                        <id>replace some config settings in app.json</id>
                        <phase>process-resources</phase>
                        <goals>
                            <goal>replace</goal>
                        </goals>
                        <configuration>
                            <basedir>${js.build.outputPath}</basedir>
                            <includes>
                                <include>**/app.json</include>
                            </includes>
                            <regex>true</regex>
                            <replacements>
                                <replacement>
                                    <!-- remove bundleLocations from app.json -->
                                    <token>\s*"bundleLocations"\s*:\s*\[\s*"localbundles"\s*,\s*"bundles"\s*\]\s*,\s*
                                    </token>
                                    <value />
                                </replacement>
                            </replacements>
                        </configuration>
                    </execution>
                    <!-- set release version -->
                    <!--<execution>-->
                        <!--<id>Set Versions to project.version</id>-->
                        <!--<phase>process-resources</phase>-->
                        <!--<goals>-->
                            <!--<goal>replace</goal>-->
                        <!--</goals>-->
                        <!--<configuration>-->
                            <!--<basedir>${js.build.outputPath}</basedir>-->
                            <!--<includes>-->
                                <!--<include>**/manifest.json</include>-->
                                <!--<include>**/package.json</include>-->
                                <!--<include>**/app.json</include>-->
                            <!--</includes>-->
                            <!--<excludes>-->
                                <!--<exclude>**/tests/**</exclude>-->
                            <!--</excludes>-->
                            <!--<regex>false</regex>-->
                            <!--<replacements>-->
                                <!--<replacement>-->
                                    <!--<token>${replace.source.version}</token>-->
                                    <!--<value>${replace.target.version}</value>-->
                                <!--</replacement>-->
                            <!--</replacements>-->
                        <!--</configuration>-->
                    <!--</execution>-->
                </executions>
            </plugin>
            <plugin>
                <groupId>org.codehaus.mojo</groupId>
                <artifactId>build-helper-maven-plugin</artifactId>
                <executions>
                    <execution>
                        <id>add-additional-artifacts-template</id>
                        <phase>package</phase>
                        <goals>
                            <goal>attach-artifact</goal>
                        </goals>
                        <configuration>
                            <artifacts>
                                <artifact>
                                    <file>${project.build.directory}/Bouwen_app.zip</file>
                                    <type>zip</type>
                                    <classifier>Bouwen_app</classifier>
                                </artifact>
                                <artifact>
                                    <file>${project.build.directory}/Geopunt-kaart_app.zip</file>
                                    <type>zip</type>
                                    <classifier>Geopunt-kaart_app</classifier>
                                </artifact>
                                <artifact>
                                    <file>${project.build.directory}/Gewestplan_app.zip</file>
                                    <type>zip</type>
                                    <classifier>Gewestplan_app</classifier>
                                </artifact>
                                <artifact>
                                    <file>${project.build.directory}/Hinder_in_kaart_app.zip</file>
                                    <type>zip</type>
                                    <classifier>Hinder_in_kaart_app</classifier>
                                </artifact>
                                <artifact>
                                    <file>${project.build.directory}/Hoogtekaart_app.zip</file>
                                    <type>zip</type>
                                    <classifier>Hoogtekaart_app</classifier>
                                </artifact>
                                <artifact>
                                    <file>${project.build.directory}/INSPIRE_app.zip</file>
                                    <type>zip</type>
                                    <classifier>INSPIRE_app</classifier>
                                </artifact>
                                <artifact>
                                    <file>${project.build.directory}/Minimaps_interface.zip</file>
                                    <type>zip</type>
                                    <classifier>Minimaps_interface</classifier>
                                </artifact>
                                <artifact>
                                    <file>${project.build.directory}/Recht_van_voorkoop-themabestand_app.zip</file>
                                    <type>zip</type>
                                    <classifier>Recht_van_voorkoop-themabestand_app</classifier>
                                </artifact>
                                <artifact>
                                    <file>${project.build.directory}/Reis_door_de_tijd_app.zip</file>
                                    <type>zip</type>
                                    <classifier>Reis_door_de_tijd_app</classifier>
                                </artifact>
                                <artifact>
                                    <file>${project.build.directory}/Vergelijk_kaarten_app.zip</file>
                                    <type>zip</type>
                                    <classifier>Vergelijk_kaarten_app</classifier>
                                </artifact>
                                <artifact>
                                    <file>${project.build.directory}/Vrije_tijd_app.zip</file>
                                    <type>zip</type>
                                    <classifier>Vrije_tijd_app</classifier>
                                </artifact>
                                <artifact>
                                    <file>${project.build.directory}/Waterlopen_app.zip</file>
                                    <type>zip</type>
                                    <classifier>Waterlopen_app</classifier>
                                </artifact>
                                <artifact>
                                    <file>${project.build.directory}/WonenLeven_app.zip</file>
                                    <type>zip</type>
                                    <classifier>WonenLeven_app</classifier>
                                </artifact>
                            </artifacts>
                        </configuration>
                    </execution>
                    <execution>
                        <id>parse-version</id>
                        <phase>process-resources</phase>
                        <goals>
                            <goal>parse-version</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>org.eclipse.jetty</groupId>
                <artifactId>jetty-maven-plugin</artifactId>
                <configuration>
                    <stopPort>9969</stopPort>
                    <stopKey>jetty-stop</stopKey>
                    <scanIntervalSeconds>0</scanIntervalSeconds>
                    <reload>manual</reload>
                    <webXml>${basedir}/src/test/webapp/WEB-INF/web.xml</webXml>
                    <useTestScope>true</useTestScope>
                    <webAppConfig>
                        <contextPath>/</contextPath>
                        <baseResource implementation="org.eclipse.jetty.util.resource.ResourceCollection">
                            <resourcesAsCSV>
                                ${basedir}/src/main,${basedir}/src/test/webapp,${project.build.directory}/${project.artifactId},${basedir}/src/test/resources
                            </resourcesAsCSV>
                        </baseResource>
                        <!-- include ct-jsregistry-embedded-<version>.jar as web-fragment provider -->
                        <webInfIncludeJarPattern>.*/ct-jsregistry-embedded-[^/]*\.jar$</webInfIncludeJarPattern>
                    </webAppConfig>
                    <systemProperties>
                        <systemProperty>
                            <!-- set catalina home, so that log files are created in the target directory-->
                            <name>catalina.home</name>
                            <value>${project.build.directory}</value>
                        </systemProperty>
                    </systemProperties>
                </configuration>
            </plugin>
            <plugin>
                <!-- we jar the ct/* js sources so that we have it present for dependency unpack goal in projects -->
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-jar-plugin</artifactId>
                <executions>
                    <execution>
                        <id>default-jar</id>
                        <phase>package</phase>
                        <goals>
                            <goal>jar</goal>
                        </goals>
                        <configuration>
                            <classesDirectory>${js.build.outputPath}</classesDirectory>
                            <includes>
                                <include>**/*</include>
                            </includes>
                            <excludes>
                                <exclude>apps/**</exclude>
                                <exclude>**/tests/**</exclude>
                            </excludes>
                        </configuration>
                    </execution>
                    <execution>
                        <id>package-sources</id>
                        <phase>process-resources</phase>
                        <goals>
                            <goal>jar</goal>
                        </goals>
                        <configuration>
                            <classesDirectory>${js.build.outputPath}</classesDirectory>
                            <classifier>sources</classifier>
                            <includes>
                                <include>**/*</include>
                            </includes>
                            <!--<excludes>-->
                                <!--<exclude>**/tests/**</exclude>-->
                                <!--<exclude>apps/**</exclude>-->
                                <!--<exclude>sample/**</exclude>-->
                            <!--</excludes>-->
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            <plugin>
                <groupId>de.conterra.mapapps</groupId>
                <artifactId>mapapps-maven-plugin</artifactId>
                <executions>
                    <!--<execution>-->
                    <!--<id>deploy-Geopunt-kaart_pro_app</id>-->
                    <!--<phase>post-integration-test</phase>-->
                    <!--<goals>-->
                    <!--<goal>deployAppTemplate</goal>-->
                    <!--</goals>-->
                    <!--<configuration>-->
                    <!--<templateName>Geopunt-kaart_pro_app</templateName>-->
                    <!--<templateTitle>Geopunt-kaart_pro_app</templateTitle>-->
                    <!--<appTitle>Geopunt-kaart pro</appTitle>-->
                    <!--<appDescription>Geopunt-kaart pro' richt zich op de professionele gebruikers.-->
                    <!--Gebruik een uitgebreid tekenpallet, voeg een eigen geografische service toe,-->
                    <!--bekijk INSPIRE datasets, enz...-->
                    <!--</appDescription>-->
                    <!--<templateFile>${project.build.directory}/Geopunt-kaart_pro_app.zip-->
                    <!--</templateFile>-->
                    <!--<templateResources>-->
                    <!--<templateResource>-->
                    <!--<directory>-->
                    <!--${js.build.outputPath}/apps/Geopunt-kaart_pro_app-->
                    <!--</directory>-->
                    <!--<includes>-->
                    <!--<include>**/*</include>-->
                    <!--</includes>-->
                    <!--</templateResource>-->
                    <!--</templateResources>-->
                    <!--</configuration>-->
                    <!--</execution>-->

                    <execution>
                        <id>deploy-Bouwen_app</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>deployAppTemplate</goal>
                        </goals>
                        <configuration>
                            <templateName>Bouwen_app</templateName>
                            <templateTitle>Bouwen_app</templateTitle>
                            <appTitle>Bouwen</appTitle>
                            <appDescription>In de kaarttoepassing \u2018Bouwen\u2019 vind je info terug over geluidsbelasting, risico op overstroming, de ligging van de rioleringen, etc.</appDescription>
                            <templateFile>${project.build.directory}/Bouwen_app.zip
                            </templateFile>
                            <templateResources>
                                <templateResource>
                                    <directory>
                                        ${js.build.outputPath}/apps/Bouwen_app
                                    </directory>
                                    <includes>
                                        <include>**/*</include>
                                    </includes>
                                </templateResource>
                            </templateResources>
                        </configuration>
                    </execution>

                    <execution>
                        <id>deploy-Geopunt-kaart_app</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>deployAppTemplate</goal>
                        </goals>
                        <configuration>
                            <templateName>Geopunt-kaart_app</templateName>
                            <templateTitle>Geopunt-kaart_app</templateTitle>
                            <appTitle>Geopunt-kaart</appTitle>
                            <appDescription>Bekijk verschillende kaarten in Vlaanderen met een verscheidenheid&lt;/br&gt;aan informatie, van luchtfoto's tot locaties van kinderopvang.&lt;/br&gt;Zoek op adressen, interessante plaatsen, perceelnummer, meet afstanden,&lt;/br&gt;bepaal routes, vraag een hoogteprofiel op, gebruik een uitgebreid tekenpallet, voeg eigen geografische services toe, etc.</appDescription>
                            <templateFile>${project.build.directory}/Geopunt-kaart_app.zip
                            </templateFile>
                            <templateResources>
                                <templateResource>
                                    <directory>
                                        ${js.build.outputPath}/apps/Geopunt-kaart_app
                                    </directory>
                                    <includes>
                                        <include>**/*</include>
                                    </includes>
                                </templateResource>
                            </templateResources>
                        </configuration>
                    </execution>

                    <execution>
                        <id>deploy-Gewestplan_app</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>deployAppTemplate</goal>
                        </goals>
                        <configuration>
                            <templateName>Gewestplan_app</templateName>
                            <templateTitle>Gewestplan_app</templateTitle>
                            <appTitle>Gewestplan</appTitle>
                            <appDescription>Bekijk hier het Gewestplan.</appDescription>
                            <templateFile>${project.build.directory}/Gewestplan_app.zip
                            </templateFile>
                            <templateResources>
                                <templateResource>
                                    <directory>
                                        ${js.build.outputPath}/apps/Gewestplan_app
                                    </directory>
                                    <includes>
                                        <include>**/*</include>
                                    </includes>
                                </templateResource>
                            </templateResources>
                        </configuration>
                    </execution>

                    <execution>
                        <id>deploy-Hinder_in_kaart_app</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>deployAppTemplate</goal>
                        </goals>
                        <configuration>
                            <templateName>Hinder_in_kaart_app</templateName>
                            <templateTitle>Hinder_in_kaart_app</templateTitle>
                            <appTitle>Hinder in kaart</appTitle>
                            <appDescription>De applicatie 'Hinder in kaart' visualiseert diverse werken en&lt;/br&gt;evenementen die een hinder kunnen veroorzaken op de weg.</appDescription>
                            <templateFile>${project.build.directory}/Hinder_in_kaart_app.zip
                            </templateFile>
                            <templateResources>
                                <templateResource>
                                    <directory>
                                        ${js.build.outputPath}/apps/Hinder_in_kaart_app
                                    </directory>
                                    <includes>
                                        <include>**/*</include>
                                    </includes>
                                </templateResource>
                            </templateResources>
                        </configuration>
                    </execution>

                    <execution>
                        <id>deploy-Hoogtekaart_app</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>deployAppTemplate</goal>
                        </goals>
                        <configuration>
                            <templateName>Hoogtekaart_app</templateName>
                            <templateTitle>Hoogtekaart_app</templateTitle>
                            <appTitle>Hoogtekaart</appTitle>
                            <appDescription>Bekijk het Digitale Hoogtemodel Vlaanderen en vraag&lt;/br&gt;het hoogteprofiel op van een traject.</appDescription>
                            <templateFile>${project.build.directory}/Hoogtekaart_app.zip
                            </templateFile>
                            <templateResources>
                                <templateResource>
                                    <directory>
                                        ${js.build.outputPath}/apps/Hoogtekaart_app
                                    </directory>
                                    <includes>
                                        <include>**/*</include>
                                    </includes>
                                </templateResource>
                            </templateResources>
                        </configuration>
                    </execution>

                    <execution>
                        <id>deploy-INSPIRE_app</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>deployAppTemplate</goal>
                        </goals>
                        <configuration>
                            <templateName>INSPIRE_app</templateName>
                            <templateTitle>INSPIRE_app</templateTitle>
                            <appTitle>INSPIRE</appTitle>
                            <appDescription>De INSPIRE-kaarttoepassing verzamelt en toont de datasets&lt;/br&gt;die onder de Europese INSPIRE-richtlijn vallen,&lt;/br&gt;geordend per INSPIRE-thema en -bijlage.</appDescription>
                            <templateFile>${project.build.directory}/INSPIRE_app.zip
                            </templateFile>
                            <templateResources>
                                <templateResource>
                                    <directory>
                                        ${js.build.outputPath}/apps/INSPIRE_app
                                    </directory>
                                    <includes>
                                        <include>**/*</include>
                                    </includes>
                                </templateResource>
                            </templateResources>
                        </configuration>
                    </execution>

                    <execution>
                        <id>deploy-Minimaps_interface</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>deployAppTemplate</goal>
                        </goals>
                        <configuration>
                            <templateName>Minimaps_interface</templateName>
                            <templateTitle>Minimaps_interface</templateTitle>
                            <appTitle>Minimaps</appTitle>
                            <appDescription />
                            <templateFile>${project.build.directory}/Minimaps_interface.zip
                            </templateFile>
                            <templateResources>
                                <templateResource>
                                    <directory>
                                        ${js.build.outputPath}/apps/Minimaps_interface
                                    </directory>
                                    <includes>
                                        <include>**/*</include>
                                    </includes>
                                </templateResource>
                            </templateResources>
                        </configuration>
                    </execution>

                    <execution>
                        <id>deploy-Recht_van_voorkoop-themabestand_app</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>deployAppTemplate</goal>
                        </goals>
                        <configuration>
                            <templateName>Recht_van_voorkoop-themabestand_app</templateName>
                            <templateTitle>Recht_van_voorkoop-themabestand_app</templateTitle>
                            <appTitle>Recht van voorkoop</appTitle>
                            <appDescription>Zoek voor een specifiek adres of perceel het recht van voorkoop op.</appDescription>
                            <templateFile>${project.build.directory}/Recht_van_voorkoop-themabestand_app.zip
                            </templateFile>
                            <templateResources>
                                <templateResource>
                                    <directory>
                                        ${js.build.outputPath}/apps/Recht_van_voorkoop-themabestand_app
                                    </directory>
                                    <includes>
                                        <include>**/*</include>
                                    </includes>
                                </templateResource>
                            </templateResources>
                        </configuration>
                    </execution>

                    <execution>
                        <id>deploy-Reis_door_de_tijd_app</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>deployAppTemplate</goal>
                        </goals>
                        <configuration>
                            <templateName>Reis_door_de_tijd_app</templateName>
                            <templateTitle>Reis_door_de_tijd_app</templateTitle>
                            <appTitle>Reis door de tijd</appTitle>
                            <appDescription>Zoek een plaats op en bekijk hoe dit punt op de kaart evolueerde van de 18de eeuw tot nu.</appDescription>
                            <templateFile>${project.build.directory}/Reis_door_de_tijd_app.zip
                            </templateFile>
                            <templateResources>
                                <templateResource>
                                    <directory>
                                        ${js.build.outputPath}/apps/Reis_door_de_tijd_app
                                    </directory>
                                    <includes>
                                        <include>**/*</include>
                                    </includes>
                                </templateResource>
                            </templateResources>
                        </configuration>
                    </execution>

                    <execution>
                        <id>deploy-Vergelijk_kaarten_app</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>deployAppTemplate</goal>
                        </goals>
                        <configuration>
                            <templateName>Vergelijk_kaarten_app</templateName>
                            <templateTitle>Vergelijk_kaarten_app</templateTitle>
                            <appTitle>Vergelijk kaarten</appTitle>
                            <appDescription>Bekijk verschillende kaarten. Leg deze naast elkaar om ze te vergelijken.</appDescription>
                            <templateFile>${project.build.directory}/Vergelijk_kaarten_app.zip
                            </templateFile>
                            <templateResources>
                                <templateResource>
                                    <directory>
                                        ${js.build.outputPath}/apps/Vergelijk_kaarten_app
                                    </directory>
                                    <includes>
                                        <include>**/*</include>
                                    </includes>
                                </templateResource>
                            </templateResources>
                        </configuration>
                    </execution>

                    <execution>
                        <id>deploy-Vrije_tijd_app</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>deployAppTemplate</goal>
                        </goals>
                        <configuration>
                            <templateName>Vrije_tijd_app</templateName>
                            <templateTitle>Vrije_tijd_app</templateTitle>
                            <appTitle>Vrije tijd</appTitle>
                            <appDescription>In de kaarttoepassing \u2018Vrije tijd\u2019 vind je tal van toeristische trekpleisters, sportaccommodaties, speelzones, bibliotheken, etc. terug in jouw buurt.</appDescription>
                            <templateFile>${project.build.directory}/Vrije_tijd_app.zip
                            </templateFile>
                            <templateResources>
                                <templateResource>
                                    <directory>
                                        ${js.build.outputPath}/apps/Vrije_tijd_app
                                    </directory>
                                    <includes>
                                        <include>**/*</include>
                                    </includes>
                                </templateResource>
                            </templateResources>
                        </configuration>
                    </execution>

                    <execution>
                        <id>deploy-Waterlopen_app</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>deployAppTemplate</goal>
                        </goals>
                        <configuration>
                            <templateName>Waterlopen_app</templateName>
                            <templateTitle>Waterlopen_app</templateTitle>
                            <appTitle>Waterlopen</appTitle>
                            <appDescription>Bekijk hier de Vlaamse waterlopen.</appDescription>
                            <templateFile>${project.build.directory}/Waterlopen_app.zip
                            </templateFile>
                            <templateResources>
                                <templateResource>
                                    <directory>
                                        ${js.build.outputPath}/apps/Waterlopen_app
                                    </directory>
                                    <includes>
                                        <include>**/*</include>
                                    </includes>
                                </templateResource>
                            </templateResources>
                        </configuration>
                    </execution>

                    <execution>
                        <id>deploy-WonenLeven_app</id>
                        <phase>post-integration-test</phase>
                        <goals>
                            <goal>deployAppTemplate</goal>
                        </goals>
                        <configuration>
                            <templateName>WonenLeven_app</templateName>
                            <templateTitle>WonenLeven_app</templateTitle>
                            <appTitle>Wonene en Leven</appTitle>
                            <appDescription>In de kaarttoepassing \u2018Wonen en leven\u2019 zie je in \u00E9\u00E9n oogopslag&lt;/br&gt;de dichtstbijzijnde kinderopvangcentra, scholen, sportaccommodaties, parkings, .. in jouw buurt.</appDescription>
                            <templateFile>${project.build.directory}/WonenLeven_app.zip
                            </templateFile>
                            <templateResources>
                                <templateResource>
                                    <directory>
                                        ${js.build.outputPath}/apps/WonenLeven_app
                                    </directory>
                                    <includes>
                                        <include>**/*</include>
                                    </includes>
                                </templateResource>
                            </templateResources>
                        </configuration>
                    </execution>

                </executions>
                <configuration>
                    <skipDeploy>true</skipDeploy>
                    <deployAsApp>true</deployAsApp>
                    <username>${deployment.admin.username}</username>
                    <password>${deployment.admin.pw}</password>
                    <appEditorState>PUBLISHED</appEditorState>
                    <serverResourcesEndpoint>${server.root.url}/${mapapps.context.name}/resources
                    </serverResourcesEndpoint>
                </configuration>
            </plugin>
        </plugins>
    </build>
    <profiles>
        <profile>
            <id>env-dev</id>
            <properties>
                <remote.host>http://localhost:8081</remote.host>
                <server.root.url>http://localhost:8081</server.root.url>
                <manager.config.viewbundles>
                    identifymanagement","servicemanagement","synonymmanagement","infoviewer","base
                </manager.config.viewbundles>
            </properties>
        </profile>
        <!--<profile>-->
        <!--<id>local-mapapps-sdi</id>-->
        <!--<dependencies>-->
        <!--map.apps sdi-->
        <!--<dependency>-->
        <!--<groupId>de.conterra.sdi-extension</groupId>-->
        <!--<artifactId>ct-sdi-extension-client</artifactId>-->
        <!--<version>${sdi.extension.version}</version>-->
        <!--<classifier>sources</classifier>-->
        <!--</dependency>-->
        <!--</dependencies>-->
        <!--</profile>-->
        <!--<profile>-->
            <!--<id>local-mapapps-fme</id>-->
            <!--<dependencies>-->
                <!--<dependency>-->
                    <!--<groupId>de.conterra.mapapps.fme</groupId>-->
                    <!--<artifactId>ct-conterra-mapapps-fme-bundles-complete</artifactId>-->
                <!--</dependency>-->
                <!--<dependency>-->
                    <!--<groupId>de.conterra.mapapps.fme</groupId>-->
                    <!--<artifactId>ct-mapapps-fme-base</artifactId>-->
                <!--</dependency>-->
            <!--</dependencies>-->
        <!--</profile>-->
        <profile>
            <id>deployConfigs</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>${project.groupId}</groupId>
                        <artifactId>ct-agiv-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>deploy-service-config-production</id>
                                <phase>post-integration-test</phase>
                                <goals>
                                    <goal>deployConfig</goal>
                                </goals>
                                <configuration>
                                    <configFile>
                                        ${basedir}/src/main/resources/ServicesManagement.json
                                    </configFile>
                                    <serverResourcesEndpoint>${agiv.config.deployserver}/services/import/all
                                    </serverResourcesEndpoint>
                                </configuration>
                            </execution>
                            <execution>
                                <id>deploy-synonyms-config-production</id>
                                <phase>post-integration-test</phase>
                                <goals>
                                    <goal>deployConfig</goal>
                                </goals>
                                <configuration>
                                    <configFile>
                                        ${basedir}/src/main/resources/SynonymManagement.json
                                    </configFile>
                                    <serverResourcesEndpoint>${agiv.config.deployserver}/synonyms/import/all
                                    </serverResourcesEndpoint>
                                </configuration>
                            </execution>
                            <execution>
                                <id>deploy-identify-config</id>
                                <phase>post-integration-test</phase>
                                <goals>
                                    <goal>deployConfig</goal>
                                </goals>
                                <configuration>
                                    <configFile>
                                        ${basedir}/src/main/resources/Identify.json
                                    </configFile>
                                    <serverResourcesEndpoint>${agiv.config.deployserver}/identify/import/all
                                    </serverResourcesEndpoint>
                                </configuration>
                            </execution>
                            <execution>
                                <id>deploy-identify-mapping</id>
                                <phase>post-integration-test</phase>
                                <goals>
                                    <goal>deployConfig</goal>
                                </goals>
                                <configuration>
                                    <configFile>
                                        ${basedir}/src/main/resources/MappingsServicesIdentify.json
                                    </configFile>
                                    <serverResourcesEndpoint>${agiv.config.deployserver}/identifymapping/import/all
                                    </serverResourcesEndpoint>
                                </configuration>
                            </execution>
                        </executions>
                        <configuration>
                            <skipDeploy>false</skipDeploy>
                            <username>${deployment.admin.username}</username>
                            <password>${deployment.admin.pw}</password>
                        </configuration>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <!-- this is the optimization profile, it executes the dojo build to compress, minimize and inline templates in dojo, esri and ct javascript sources -->
            <!-- it must be explicitly activated by -P compress flag, also at release time -->
            <id>compress</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>de.conterra.jsregistry</groupId>
                        <artifactId>ct-jsregistry-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>calculate js dependencies</id>
                                <goals>
                                    <goal>calculateDependencies</goal>
                                </goals>
                            </execution>
                            <execution>
                                <id>optimize js</id>
                                <goals>
                                    <goal>optimizeJS</goal>
                                </goals>
                                <configuration>
                                    <hasFeatures>
                                        <ct-debug>false</ct-debug>
                                    </hasFeatures>
                                    <jsFiles>
                                        <excludes>
                                            <exclude>apps/**</exclude>
                                            <exclude>**/tests/**</exclude>
                                        </excludes>
                                    </jsFiles>
                                </configuration>
                            </execution>
                            <execution>
                                <id>optimize CSS</id>
                                <goals>
                                    <goal>optimizeCSS</goal>
                                </goals>
                                <phase>compile</phase>
                                <configuration>
                                    <cssFiles>
                                        <includes>
                                            <include>bundles/**/*.css</include>
                                        </includes>
                                        <excludes>
                                            <exclude>**/themeSettings.css</exclude>
                                        </excludes>
                                    </cssFiles>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>upload</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>de.conterra.mapapps</groupId>
                        <artifactId>mapapps-maven-plugin</artifactId>
                        <configuration>
                            <skipDeploy>false</skipDeploy>
                        </configuration>
                    </plugin>
                    <plugin>
                        <groupId>de.conterra.jsregistry</groupId>
                        <artifactId>ct-jsregistry-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>deploy bundles</id>
                                <goals>
                                    <goal>deployJSPackage</goal>
                                </goals>
                                <configuration>
                                    <username>${deployment.admin.username}</username>
                                    <password>${deployment.admin.pw}</password>
                                    <registryEndpoint>${server.root.url}/${mapapps.context.name}/resources/jsregistry
                                    </registryEndpoint>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>upload-apps</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>de.conterra.mapapps</groupId>
                        <artifactId>mapapps-maven-plugin</artifactId>
                        <configuration>
                            <skipDeploy>false</skipDeploy>
                        </configuration>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>less-v8-x32</id>
            <activation>
                <property>
                    <name>sun.arch.data.model</name>
                    <value>32</value>
                </property>
            </activation>
            <build>
                <pluginManagement>
                    <plugins>
                        <plugin>
                            <groupId>org.lesscss</groupId>
                            <artifactId>lesscss-maven-plugin</artifactId>
                            <dependencies>
                                <dependency>
                                    <groupId>lu.flier.script</groupId>
                                    <artifactId>jav8-win32</artifactId>
                                    <version>0.4</version>
                                </dependency>
                            </dependencies>
                        </plugin>
                    </plugins>
                </pluginManagement>
            </build>
        </profile>
        <profile>
            <id>less-v8-x64</id>
            <activation>
                <property>
                    <name>sun.arch.data.model</name>
                    <value>64</value>
                </property>
            </activation>
            <build>
                <pluginManagement>
                    <plugins>
                        <plugin>
                            <groupId>org.lesscss</groupId>
                            <artifactId>lesscss-maven-plugin</artifactId>
                            <dependencies>
                                <dependency>
                                    <groupId>lu.flier.script</groupId>
                                    <artifactId>jav8-win64</artifactId>
                                    <version>0.6</version>
                                </dependency>
                            </dependencies>
                        </plugin>
                    </plugins>
                </pluginManagement>
            </build>
        </profile>
        <profile>
            <id>less-v8-x64-mac</id>
            <activation>
                <os>
                    <family>mac</family>
                </os>
            </activation>
            <build>
                <pluginManagement>
                    <plugins>
                        <plugin>
                            <groupId>org.lesscss</groupId>
                            <artifactId>lesscss-maven-plugin</artifactId>
                            <dependencies>
                                <dependency>
                                    <groupId>lu.flier.script</groupId>
                                    <artifactId>jav8-macosx86_64</artifactId>
                                    <version>0.6</version>
                                </dependency>
                            </dependencies>
                        </plugin>
                    </plugins>
                </pluginManagement>
            </build>
        </profile>
        <profile>
            <id>run-js-tests</id>
            <build>
                <plugins>
                    <plugin>
                        <groupId>org.codehaus.mojo</groupId>
                        <artifactId>build-helper-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>reserve-jetty-port</id>
                                <goals>
                                    <goal>reserve-network-port</goal>
                                </goals>
                                <phase>process-test-classes</phase>
                                <configuration>
                                    <portNames>
                                        <portName>jetty.server.port</portName>
                                    </portNames>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                    <plugin>
                        <groupId>org.eclipse.jetty</groupId>
                        <artifactId>jetty-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <id>jetty-start</id>
                                <phase>process-test-classes</phase>
                                <goals>
                                    <goal>start</goal>
                                </goals>
                                <configuration>
                                    <contextPath>/</contextPath>
                                    <httpConnector>
                                        <port>${jetty.server.port}</port>
                                    </httpConnector>
                                    <scanIntervalSeconds>0</scanIntervalSeconds>
                                    <daemon>true</daemon>
                                </configuration>
                            </execution>
                            <execution>
                                <id>jetty-stop</id>
                                <phase>prepare-package</phase>
                                <goals>
                                    <goal>stop</goal>
                                </goals>
                            </execution>
                        </executions>
                    </plugin>
                    <plugin>
                        <groupId>de.conterra.jsrt</groupId>
                        <artifactId>ct-jsrt-test-maven-plugin</artifactId>
                        <executions>
                            <execution>
                                <phase>test</phase>
                                <goals>
                                    <goal>runTests</goal>
                                </goals>
                            </execution>
                        </executions>
                        <configuration>
                            <initialDelay>2000</initialDelay>
                            <timeout>60000</timeout>
                            <tests>
                                <test>
                                    http://localhost:${jetty.server.port}/resources/jsregistry/root/doh/1.10.0/runner.html?boot=/js/tests/test-init.js&amp;noRobots=true&amp;test=base/tests/module
                                </test>
                                <test>http://localhost:${jetty.server.port}/resources/jsregistry/root/intern-geezer/2.1.1/runner.html?boot=/js/tests/test-init.js&amp;test=base/tests/intern-all</test>
                                <!-- sample app integration tests -->
                                <!--<test>http://localhost:${jetty.server.port}/resources/jsregistry/root/intern-geezer/2.1.1/runner.html?boot=../../../../../js/sample/test-init.js&amp;test=sample_apps/intern-all</test>-->
                            </tests>
                        </configuration>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>write-release-versions</id>
            <properties>
                <replace.target.version>${project.version}</replace.target.version>
                <replace.source.version>5.0.4-SNAPSHOT</replace.source.version>
            </properties>
            <build>
                <plugins>
                    <plugin>
                        <!-- ensure correct version in the manifest.json files-->
                        <groupId>com.google.code.maven-replacer-plugin</groupId>
                        <artifactId>replacer</artifactId>
                        <executions>
                            <!-- set release version -->
                            <execution>
                                <id>Set Versions from ${replace.source.version} to ${replace.target.version}</id>
                                <phase>validate</phase>
                                <goals>
                                    <goal>replace</goal>
                                </goals>
                                <configuration>
                                    <basedir>${basedir}</basedir>
                                    <includes>
                                        <include>src/main/js/**/manifest.json</include>
                                        <include>src/main/js/**/package.json</include>
                                    </includes>
                                    <excludes>
                                        <exclude>src/main/js/**/tests/**</exclude>
                                    </excludes>
                                    <regex>false</regex>
                                    <replacements>
                                        <replacement>
                                            <token>"${replace.source.version}"</token>
                                            <value>"${replace.target.version}"</value>
                                        </replacement>
                                        <replacement>
                                            <token>"~${replace.source.version}"</token>
                                            <value>"~${replace.target.version}"</value>
                                        </replacement>
                                    </replacements>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
        <profile>
            <id>commit-release-versions</id>
            <build>
                <plugins>
                    <plugin>
                        <artifactId>maven-scm-plugin</artifactId>
                        <executions>
                            <execution>
                                <phase>validate</phase>
                                <goals>
                                    <goal>checkin</goal>
                                    <goal>update</goal>
                                </goals>
                                <configuration>
                                    <message>[update-bundle-package-versions] from ${replace.source.version} to ${replace.target.version}</message>
                                    <basedir>${basedir}/src/main/js</basedir>
                                </configuration>
                            </execution>
                        </executions>
                    </plugin>
                </plugins>
            </build>
        </profile>
    </profiles>
    <properties>
        <mapapps.build.outputPath>${project.build.directory}/unpacked</mapapps.build.outputPath>
    </properties>

</project>